{
  "hash": "7de88fb757a9cd9a2ff18983985f874b",
  "result": {
    "markdown": "---\ntitle: \"Take-home Exercise 2\"\nauthor: \"Leow Xian Zu\"\ndate: \"23 Sep 2024\"\ndate-modified: \"last-modified\"\nexecute:\n  eval: true\n  echo: true \n  message: false #no more warning message\n  freeze: true #whatever document already commited does not render\n---\n\n\ntourism revenue no tevenly distributed. there are variations.\n\nour interest is where they are located. spatial dsitribution.\n\nlook into where are the hotspots, spatial autocorrelation, where are the clusters, outliers,\n\nwe want to see the tynamic of it. we want to know which one changed most significantly over time and how we classified them.\n\nwe are looking at key indicators of tourism economy. it's NOT 1 only. there are more than 1 indicators.\n\nlike , total revenue, is 1 indicator. see if there are any others.\n\nif tourism economy is dependent on space and time, we wanna find cluster, outlier, hotspot and coldspot.\n\ndata, province level, incl. bangkok. we used it before. we only need the province level. just one.\n\nattribute in thin and long several years and attribute. reorganise table for analysis.\n\nGeosptial data is high resolution. many small islands. we need to be careful about centroids don't end up in water.\n\nrevenue covers precovid during covid and post covid. inherent patterns. pre-covid has change already. We are more interested in space time changes.\n\nSpatial, unequal also. bangkok highest. How these spatial changes over time.\n\nkey indicator(S). look at multiple and different measures to allow us to better understand tourism economy.\n\nThailand administrative level 0 (country), 1 (province), 2 (district), 3 (sub-district, tambon) gazetteer. Need to include bangkok but bangkok is a city\n\nNeed to change the month into integers to do spacetime cube.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load required libraries\nlibrary(sf)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'sf' was built under R version 4.3.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nLinking to GEOS 3.11.2, GDAL 3.8.2, PROJ 9.3.1; sf_use_s2() is TRUE\n```\n:::\n\n```{.r .cell-code}\nlibrary(ggplot2)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'ggplot2' was built under R version 4.3.3\n```\n:::\n\n```{.r .cell-code}\n# Import the shapefile\nthailand <- st_read(\"data/tha_admbnda_adm1_rtsd_20220121.shp\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nReading layer `tha_admbnda_adm1_rtsd_20220121' from data source \n  `C:\\zzzzzuu\\ISSS626GAA\\Take-home_Ex\\Take-home_Ex02\\data\\tha_admbnda_adm1_rtsd_20220121.shp' \n  using driver `ESRI Shapefile'\nSimple feature collection with 77 features and 16 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 97.34336 ymin: 5.613038 xmax: 105.637 ymax: 20.46507\nGeodetic CRS:  WGS 84\n```\n:::\n\n```{.r .cell-code}\n# Plot the map\nggplot() +\n  geom_sf(data = thailand) +\n  theme_minimal() +\n  labs(title = \"Thailand Administrative Boundaries (Province Level)\")\n```\n\n::: {.cell-output-display}\n![](Take-home_Ex02_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nthailand_utm <- st_transform(thailand, crs = 32647)\nthailand_utm\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSimple feature collection with 77 features and 16 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 325178.8 ymin: 620860.6 xmax: 1213656 ymax: 2263241\nProjected CRS: WGS 84 / UTM zone 47N\nFirst 10 features:\n   Shape_Leng Shape_Area                  ADM1_EN       ADM1_TH ADM1_PCODE\n1    2.417227 0.13133873                  Bangkok  กรุงเทพมหานคร       TH10\n2    1.695100 0.07926199             Samut Prakan    สมุทรปราการ       TH11\n3    1.251111 0.05323766               Nonthaburi         นนทบุรี       TH12\n4    1.884945 0.12698345             Pathum Thani        ปทุมธานี       TH13\n5    3.041716 0.21393797 Phra Nakhon Si Ayutthaya พระนครศรีอยุธยา       TH14\n6    1.739908 0.07920961                Ang Thong        อ่างทอง       TH15\n7    5.693342 0.54578838                 Lop Buri          ลพบุรี       TH16\n8    1.778326 0.06872655                Sing Buri         สิงห์บุรี       TH17\n9    2.896316 0.20907828                 Chai Nat         ชัยนาท       TH18\n10   4.766446 0.29208711                 Saraburi         สระบุรี       TH19\n   ADM1_REF ADM1ALT1EN ADM1ALT2EN ADM1ALT1TH ADM1ALT2TH  ADM0_EN   ADM0_TH\n1      <NA>       <NA>       <NA>       <NA>       <NA> Thailand ประเทศไทย\n2      <NA>       <NA>       <NA>       <NA>       <NA> Thailand ประเทศไทย\n3      <NA>       <NA>       <NA>       <NA>       <NA> Thailand ประเทศไทย\n4      <NA>       <NA>       <NA>       <NA>       <NA> Thailand ประเทศไทย\n5      <NA>       <NA>       <NA>       <NA>       <NA> Thailand ประเทศไทย\n6      <NA>       <NA>       <NA>       <NA>       <NA> Thailand ประเทศไทย\n7      <NA>       <NA>       <NA>       <NA>       <NA> Thailand ประเทศไทย\n8      <NA>       <NA>       <NA>       <NA>       <NA> Thailand ประเทศไทย\n9      <NA>       <NA>       <NA>       <NA>       <NA> Thailand ประเทศไทย\n10     <NA>       <NA>       <NA>       <NA>       <NA> Thailand ประเทศไทย\n   ADM0_PCODE       date    validOn    validTo                       geometry\n1          TH 2019-02-18 2022-01-22 -001-11-30 MULTIPOLYGON (((674339.8 15...\n2          TH 2019-02-18 2022-01-22 -001-11-30 MULTIPOLYGON (((687139.8 15...\n3          TH 2019-02-18 2022-01-22 -001-11-30 MULTIPOLYGON (((644817.9 15...\n4          TH 2019-02-18 2022-01-22 -001-11-30 MULTIPOLYGON (((704086 1575...\n5          TH 2019-02-18 2022-01-22 -001-11-30 MULTIPOLYGON (((662941.6 16...\n6          TH 2019-02-18 2022-01-22 -001-11-30 MULTIPOLYGON (((643472.8 16...\n7          TH 2019-02-18 2022-01-22 -001-11-30 MULTIPOLYGON (((751293.3 17...\n8          TH 2019-02-18 2022-01-22 -001-11-30 MULTIPOLYGON (((647136.1 16...\n9          TH 2019-02-18 2022-01-22 -001-11-30 MULTIPOLYGON (((620165.4 17...\n10         TH 2019-02-18 2022-01-22 -001-11-30 MULTIPOLYGON (((757935.1 16...\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load required libraries\nlibrary(readr)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'readr' was built under R version 4.3.3\n```\n:::\n\n```{.r .cell-code}\nlibrary(dplyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'dplyr' was built under R version 4.3.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'dplyr'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n```\n:::\n\n```{.r .cell-code}\nlibrary(tidyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'tidyr' was built under R version 4.3.3\n```\n:::\n\n```{.r .cell-code}\n# Import the CSV file\ntourism_data <- read_csv(\"data/thailand_domestic_tourism_2019_2023_ver2.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 30800 Columns: 7\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (5): province_thai, province_eng, region_thai, region_eng, variable\ndbl  (1): value\ndate (1): date\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n\n```{.r .cell-code}\n# Display the first few rows and structure of the data\nprint(head(tourism_data))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 7\n  date       province_thai province_eng    region_thai region_eng variable value\n  <date>     <chr>         <chr>           <chr>       <chr>      <chr>    <dbl>\n1 2019-01-01 กรุงเทพมหานคร  Bangkok         ภาคกลาง     central    ratio_t…  93.4\n2 2019-01-01 ลพบุรี          Lopburi         ภาคกลาง     central    ratio_t…  61.3\n3 2019-01-01 พระนครศรีอยุธยา Phra Nakhon Si… ภาคกลาง     central    ratio_t…  73.4\n4 2019-01-01 สระบุรี         Saraburi        ภาคกลาง     central    ratio_t…  67.3\n5 2019-01-01 ชัยนาท         Chainat         ภาคกลาง     central    ratio_t…  79.3\n6 2019-01-01 นครปฐม        Nakhon Pathom   ภาคกลาง     central    ratio_t…  71.7\n```\n:::\n\n```{.r .cell-code}\nglimpse(tourism_data)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 30,800\nColumns: 7\n$ date          <date> 2019-01-01, 2019-01-01, 2019-01-01, 2019-01-01, 2019-01…\n$ province_thai <chr> \"กรุงเทพมหานคร\", \"ลพบุรี\", \"พระนครศรีอยุธยา\", \"สระบุรี\", \"ชัยนาท…\n$ province_eng  <chr> \"Bangkok\", \"Lopburi\", \"Phra Nakhon Si Ayutthaya\", \"Sarab…\n$ region_thai   <chr> \"ภาคกลาง\", \"ภาคกลาง\", \"ภาคกลาง\", \"ภาคกลาง\", \"ภาคกลาง\", \"…\n$ region_eng    <chr> \"central\", \"central\", \"central\", \"central\", \"central\", \"…\n$ variable      <chr> \"ratio_tourist_stay\", \"ratio_tourist_stay\", \"ratio_touri…\n$ value         <dbl> 93.37, 61.32, 73.37, 67.33, 79.31, 71.70, 64.65, 71.21, …\n```\n:::\n\n```{.r .cell-code}\n# Check for any missing values\nsum(is.na(tourism_data))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0\n```\n:::\n\n```{.r .cell-code}\n# Clean and prepare the data\ntourism_data_clean <- tourism_data %>%\n  # Remove any rows with missing values\n  na.omit() %>%\n  # Ensure province names match those in the shapefile (you may need to adjust this)\n  mutate(province_eng = toupper(province_eng))\n\n# Display the first few rows of the cleaned data\nprint(head(tourism_data_clean))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 7\n  date       province_thai province_eng    region_thai region_eng variable value\n  <date>     <chr>         <chr>           <chr>       <chr>      <chr>    <dbl>\n1 2019-01-01 กรุงเทพมหานคร  BANGKOK         ภาคกลาง     central    ratio_t…  93.4\n2 2019-01-01 ลพบุรี          LOPBURI         ภาคกลาง     central    ratio_t…  61.3\n3 2019-01-01 พระนครศรีอยุธยา PHRA NAKHON SI… ภาคกลาง     central    ratio_t…  73.4\n4 2019-01-01 สระบุรี         SARABURI        ภาคกลาง     central    ratio_t…  67.3\n5 2019-01-01 ชัยนาท         CHAINAT         ภาคกลาง     central    ratio_t…  79.3\n6 2019-01-01 นครปฐม        NAKHON PATHOM   ภาคกลาง     central    ratio_t…  71.7\n```\n:::\n\n```{.r .cell-code}\n# pivot the data to have variables as columns\ntourism_wide <- tourism_data_clean %>%\n  pivot_wider(\n    id_cols = c(province_eng, date),\n    names_from = variable,\n    values_from = value\n  )\n\n# Display the wide format data\nprint(head(tourism_wide))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 10\n  province_eng      date       ratio_tourist_stay no_tourist_stay no_tourist_all\n  <chr>             <date>                  <dbl>           <dbl>          <dbl>\n1 BANGKOK           2019-01-01               93.4         3334971        5959075\n2 LOPBURI           2019-01-01               61.3           51858         268664\n3 PHRA NAKHON SI A… 2019-01-01               73.4          117052         730329\n4 SARABURI          2019-01-01               67.3           89850         207236\n5 CHAINAT           2019-01-01               79.3           27141          79073\n6 NAKHON PATHOM     2019-01-01               71.7          118629         296107\n# ℹ 5 more variables: no_tourist_thai <dbl>, no_tourist_foreign <dbl>,\n#   revenue_all <dbl>, revenue_thai <dbl>, revenue_foreign <dbl>\n```\n:::\n:::\n",
    "supporting": [
      "Take-home_Ex02_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}