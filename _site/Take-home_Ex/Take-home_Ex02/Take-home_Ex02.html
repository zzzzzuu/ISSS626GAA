<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Leow Xian Zu">
<meta name="dcterms.date" content="2024-09-23">

<title>Xian Zu’s website for ISSS626GAA - Take-home Exercise 2</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<link href="../../site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="../../site_libs/plotly-binding-4.10.4/plotly.js"></script>
<script src="../../site_libs/typedarray-0.1/typedarray.min.js"></script>
<script src="../../site_libs/jquery-3.5.1/jquery.min.js"></script>
<link href="../../site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="../../site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<link href="../../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="../../site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Xian Zu’s website for ISSS626GAA</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Hands-on Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercise">    
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex02/Hands-on_Ex02.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex03/Hands-on_Ex03.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex04/Hands-on_Ex04.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex06/Hands-on_Ex06.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex07/Hands-on_Ex07.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 7</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex08/Hands-on_Ex08.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 8</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex09/Hands-on_Ex09.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 9</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex09/Hands-on_Ex10.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 10</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">In-class Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercise">    
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex01/In-class_Ex01.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex02/In-class_Ex02.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex03/In-class_Ex03.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex04/In-class_Ex04.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex05/In-class_Ex05.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex06/In-class_Ex06.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex07/In-class_Ex07.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 7</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex08/In-class_Ex08.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 8</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex09/In-class_Ex09.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 9</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex09/In-class_Ex10.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 10</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Take-home Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercise">    
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex01/Take-home_Ex01.html" rel="" target="">
 <span class="dropdown-text">Take-home Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex02/Take-home_Ex02.html" rel="" target="">
 <span class="dropdown-text">Take-home Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex03/Take-home_Ex03.html" rel="" target="">
 <span class="dropdown-text">Take-home Exercise 3</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#foreword" id="toc-foreword" class="nav-link active" data-scroll-target="#foreword">Foreword</a></li>
  <li><a href="#set-up" id="toc-set-up" class="nav-link" data-scroll-target="#set-up">Set up</a></li>
  <li><a href="#exploratory-spatial-data-analysis" id="toc-exploratory-spatial-data-analysis" class="nav-link" data-scroll-target="#exploratory-spatial-data-analysis">Exploratory Spatial Data Analysis</a>
  <ul class="collapse">
  <li><a href="#what-data-do-we-have" id="toc-what-data-do-we-have" class="nav-link" data-scroll-target="#what-data-do-we-have">What data do we have?</a></li>
  <li><a href="#join-data" id="toc-join-data" class="nav-link" data-scroll-target="#join-data">Join data</a></li>
  <li><a href="#take-a-look-at-chloropleth-maps" id="toc-take-a-look-at-chloropleth-maps" class="nav-link" data-scroll-target="#take-a-look-at-chloropleth-maps">Take a look at chloropleth maps</a></li>
  </ul></li>
  <li><a href="#global-morans-i-test" id="toc-global-morans-i-test" class="nav-link" data-scroll-target="#global-morans-i-test">Global Moran’s I test</a></li>
  <li><a href="#local-indicators-of-spatial-association" id="toc-local-indicators-of-spatial-association" class="nav-link" data-scroll-target="#local-indicators-of-spatial-association">Local Indicators of Spatial Association</a></li>
  <li><a href="#hot-spot-and-cold-spot-area-analysis-hcsa" id="toc-hot-spot-and-cold-spot-area-analysis-hcsa" class="nav-link" data-scroll-target="#hot-spot-and-cold-spot-area-analysis-hcsa"><strong>Hot Spot and Cold Spot Area Analysis (HCSA)</strong></a></li>
  <li><a href="#emerging-hot-spot-cold-spot-analysis" id="toc-emerging-hot-spot-cold-spot-analysis" class="nav-link" data-scroll-target="#emerging-hot-spot-cold-spot-analysis">Emerging hot spot cold spot analysis</a>
  <ul class="collapse">
  <li><a href="#computing-gi" id="toc-computing-gi" class="nav-link" data-scroll-target="#computing-gi">Computing Gi*</a></li>
  <li><a href="#man-kendall-test" id="toc-man-kendall-test" class="nav-link" data-scroll-target="#man-kendall-test">Man Kendall Test</a></li>
  <li><a href="#emerging-hot-spot-and-cold-spot" id="toc-emerging-hot-spot-and-cold-spot" class="nav-link" data-scroll-target="#emerging-hot-spot-and-cold-spot">Emerging hot spot and cold spot</a></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Take-home Exercise 2</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Leow Xian Zu </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">September 23, 2024</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">October 12, 2024</p>
    </div>
  </div>
    
  </div>
  

</header>

<section id="foreword" class="level1">
<h1>Foreword</h1>
<p>Tourism plays a vital role in Thailand’s economy, contributing significantly to its gross domestic product (GDP). In 2019, the country’s tourism sector generated S$106 billion from both domestic and international visitors, accounting for approximately 20% of the nation’s GDP. In comparison, Singapore’s tourism contributes to only 3-4% of our GDP.</p>
<p>However, the COVID-19 pandemic dealt a severe blow to this thriving industry, causing revenues to plummet to S$31 billion in 2020.</p>
<p>Despite this setback, recent data indicates a gradual recovery in Thailand’s tourism sector. However, it is crucial to note that the tourism economy is not uniformly distributed across the country. Three provinces—Bangkok, Phuket, and Chiang Mai—have historically been the focal points of Thailand’s tourism industry.</p>
<p>Given this context, this report aims to conduct a comprehensive spatial and spatio-temporal analysis of Thailand’s tourism economy at the province level, with a particular focus on the impacts of COVID-19. The primary objectives of this study are:</p>
<ol type="1">
<li><p>To determine whether key indicators of Thailand’s tourism economy exhibit spatial and spatio-temporal dependence.</p></li>
<li><p>If such dependence is established, to identify clusters, outliers, and emerging hot/cold spot areas within the country.</p></li>
</ol>
<p>To achieve these objectives, this report will employ various spatial and spatio-temporal statistical methods, including:</p>
<ul>
<li><p>Global spatial autocorrelation analysis</p></li>
<li><p>Local spatial autocorrelation analysis</p></li>
<li><p>Emerging hotspot analysis</p></li>
</ul>
<p>By utilising these geospatial analytics techniques, this study seeks to provide insights into the changing dynamics of Thailand’s tourism economy in the wake of the COVID-19 pandemic. These findings could prove useful for policymakers, industry stakeholders, and researchers in understanding the spatial patterns of tourism recovery and planning for resilience in the sector.</p>
</section>
<section id="set-up" class="level1">
<h1>Set up</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load required libraries</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  tidyverse,    <span class="co"># for data manipulation and visualization</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  sf,           <span class="co"># for spatial data handling</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  sfdep,        <span class="co"># for spatial dependence in sf</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  tmap,         <span class="co"># for thematic maps</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  lubridate,    <span class="co"># for date/time manipulation</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  ggplot2,      <span class="co"># for advanced plotting</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  plotly,       <span class="co"># for plotly tool</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  readr         <span class="co"># for importing data</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Import the shapefile</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>thailand <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">"data/tha_admbnda_adm1_rtsd_20220121.shp"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `tha_admbnda_adm1_rtsd_20220121' from data source 
  `C:\zzzzzuu\ISSS626GAA\Take-home_Ex\Take-home_Ex02\data\tha_admbnda_adm1_rtsd_20220121.shp' 
  using driver `ESRI Shapefile'
Simple feature collection with 77 features and 16 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 97.34336 ymin: 5.613038 xmax: 105.637 ymax: 20.46507
Geodetic CRS:  WGS 84</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the map</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> thailand) <span class="sc">+</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Thailand Administrative Boundaries (Province Level)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>This appears to be the correct boundaries. Let’s change it to the right CRS first, to be correct, even though it will not affect out analysis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>thailand_utm <span class="ot">&lt;-</span> <span class="fu">st_transform</span>(thailand, <span class="at">crs =</span> <span class="dv">32647</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ADM1_EN =</span> <span class="fu">toupper</span>(ADM1_EN))</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>thailand_utm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 77 features and 16 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 325178.8 ymin: 620860.6 xmax: 1213656 ymax: 2263241
Projected CRS: WGS 84 / UTM zone 47N
First 10 features:
   Shape_Leng Shape_Area                  ADM1_EN       ADM1_TH ADM1_PCODE
1    2.417227 0.13133873                  BANGKOK  กรุงเทพมหานคร       TH10
2    1.695100 0.07926199             SAMUT PRAKAN    สมุทรปราการ       TH11
3    1.251111 0.05323766               NONTHABURI         นนทบุรี       TH12
4    1.884945 0.12698345             PATHUM THANI        ปทุมธานี       TH13
5    3.041716 0.21393797 PHRA NAKHON SI AYUTTHAYA พระนครศรีอยุธยา       TH14
6    1.739908 0.07920961                ANG THONG        อ่างทอง       TH15
7    5.693342 0.54578838                 LOP BURI          ลพบุรี       TH16
8    1.778326 0.06872655                SING BURI         สิงห์บุรี       TH17
9    2.896316 0.20907828                 CHAI NAT         ชัยนาท       TH18
10   4.766446 0.29208711                 SARABURI         สระบุรี       TH19
   ADM1_REF ADM1ALT1EN ADM1ALT2EN ADM1ALT1TH ADM1ALT2TH  ADM0_EN   ADM0_TH
1      &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt; Thailand ประเทศไทย
2      &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt; Thailand ประเทศไทย
3      &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt; Thailand ประเทศไทย
4      &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt; Thailand ประเทศไทย
5      &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt; Thailand ประเทศไทย
6      &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt; Thailand ประเทศไทย
7      &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt; Thailand ประเทศไทย
8      &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt; Thailand ประเทศไทย
9      &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt; Thailand ประเทศไทย
10     &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt;       &lt;NA&gt; Thailand ประเทศไทย
   ADM0_PCODE       date    validOn    validTo                       geometry
1          TH 2019-02-18 2022-01-22 -001-11-30 MULTIPOLYGON (((674339.8 15...
2          TH 2019-02-18 2022-01-22 -001-11-30 MULTIPOLYGON (((687139.8 15...
3          TH 2019-02-18 2022-01-22 -001-11-30 MULTIPOLYGON (((644817.9 15...
4          TH 2019-02-18 2022-01-22 -001-11-30 MULTIPOLYGON (((704086 1575...
5          TH 2019-02-18 2022-01-22 -001-11-30 MULTIPOLYGON (((662941.6 16...
6          TH 2019-02-18 2022-01-22 -001-11-30 MULTIPOLYGON (((643472.8 16...
7          TH 2019-02-18 2022-01-22 -001-11-30 MULTIPOLYGON (((751293.3 17...
8          TH 2019-02-18 2022-01-22 -001-11-30 MULTIPOLYGON (((647136.1 16...
9          TH 2019-02-18 2022-01-22 -001-11-30 MULTIPOLYGON (((620165.4 17...
10         TH 2019-02-18 2022-01-22 -001-11-30 MULTIPOLYGON (((757935.1 16...</code></pre>
</div>
</div>
<p>Let’s import the data and change it to wide form.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import the CSV file</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>tourism_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/thailand_domestic_tourism_2019_2023_ver2.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 30800 Columns: 7
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr  (5): province_thai, province_eng, region_thai, region_eng, variable
dbl  (1): value
date (1): date

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the first few rows and structure of the data to check</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(tourism_data))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 7
  date       province_thai province_eng    region_thai region_eng variable value
  &lt;date&gt;     &lt;chr&gt;         &lt;chr&gt;           &lt;chr&gt;       &lt;chr&gt;      &lt;chr&gt;    &lt;dbl&gt;
1 2019-01-01 กรุงเทพมหานคร  Bangkok         ภาคกลาง     central    ratio_t…  93.4
2 2019-01-01 ลพบุรี          Lopburi         ภาคกลาง     central    ratio_t…  61.3
3 2019-01-01 พระนครศรีอยุธยา Phra Nakhon Si… ภาคกลาง     central    ratio_t…  73.4
4 2019-01-01 สระบุรี         Saraburi        ภาคกลาง     central    ratio_t…  67.3
5 2019-01-01 ชัยนาท         Chainat         ภาคกลาง     central    ratio_t…  79.3
6 2019-01-01 นครปฐม        Nakhon Pathom   ภาคกลาง     central    ratio_t…  71.7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(tourism_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 30,800
Columns: 7
$ date          &lt;date&gt; 2019-01-01, 2019-01-01, 2019-01-01, 2019-01-01, 2019-01…
$ province_thai &lt;chr&gt; "กรุงเทพมหานคร", "ลพบุรี", "พระนครศรีอยุธยา", "สระบุรี", "ชัยนาท…
$ province_eng  &lt;chr&gt; "Bangkok", "Lopburi", "Phra Nakhon Si Ayutthaya", "Sarab…
$ region_thai   &lt;chr&gt; "ภาคกลาง", "ภาคกลาง", "ภาคกลาง", "ภาคกลาง", "ภาคกลาง", "…
$ region_eng    &lt;chr&gt; "central", "central", "central", "central", "central", "…
$ variable      &lt;chr&gt; "ratio_tourist_stay", "ratio_tourist_stay", "ratio_touri…
$ value         &lt;dbl&gt; 93.37, 61.32, 73.37, 67.33, 79.31, 71.70, 64.65, 71.21, …</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for any missing values</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(tourism_data))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean and prepare the data</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>tourism_data_clean <span class="ot">&lt;-</span> tourism_data <span class="sc">%&gt;%</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Remove any rows with missing values</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="sc">%&gt;%</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">province_eng =</span> <span class="fu">toupper</span>(province_eng))</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the first few rows of the cleaned data</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(tourism_data_clean))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 7
  date       province_thai province_eng    region_thai region_eng variable value
  &lt;date&gt;     &lt;chr&gt;         &lt;chr&gt;           &lt;chr&gt;       &lt;chr&gt;      &lt;chr&gt;    &lt;dbl&gt;
1 2019-01-01 กรุงเทพมหานคร  BANGKOK         ภาคกลาง     central    ratio_t…  93.4
2 2019-01-01 ลพบุรี          LOPBURI         ภาคกลาง     central    ratio_t…  61.3
3 2019-01-01 พระนครศรีอยุธยา PHRA NAKHON SI… ภาคกลาง     central    ratio_t…  73.4
4 2019-01-01 สระบุรี         SARABURI        ภาคกลาง     central    ratio_t…  67.3
5 2019-01-01 ชัยนาท         CHAINAT         ภาคกลาง     central    ratio_t…  79.3
6 2019-01-01 นครปฐม        NAKHON PATHOM   ภาคกลาง     central    ratio_t…  71.7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Pivot the data to have variables as columns</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>tourism_wide <span class="ot">&lt;-</span> tourism_data_clean <span class="sc">%&gt;%</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">id_cols =</span> <span class="fu">c</span>(province_eng, date),</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">names_from =</span> variable,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">values_from =</span> value</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>tourism_wide <span class="ot">&lt;-</span> tourism_wide <span class="sc">%&gt;%</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">province_eng =</span> <span class="fu">case_when</span>(</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>    province_eng <span class="sc">==</span> <span class="st">"PHANG NGA"</span> <span class="sc">~</span> <span class="st">"PHANGNGA"</span>,</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>    province_eng <span class="sc">==</span> <span class="st">"LOPBURI"</span> <span class="sc">~</span> <span class="st">"LOP BURI"</span>,</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>    province_eng <span class="sc">==</span> <span class="st">"CHAINAT"</span> <span class="sc">~</span> <span class="st">"CHAI NAT"</span>,</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>    province_eng <span class="sc">==</span> <span class="st">"CHONBURI"</span> <span class="sc">~</span> <span class="st">"CHON BURI"</span>,</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>    province_eng <span class="sc">==</span> <span class="st">"PRACHINBURI"</span> <span class="sc">~</span> <span class="st">"PRACHIN BURI"</span>,</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>    province_eng <span class="sc">==</span> <span class="st">"BURIRAM"</span> <span class="sc">~</span> <span class="st">"BURI RAM"</span>,</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>    province_eng <span class="sc">==</span> <span class="st">"SISAKET"</span> <span class="sc">~</span> <span class="st">"SI SA KET"</span>,</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>    province_eng <span class="sc">==</span> <span class="st">"NONG BUA LAMPHU"</span> <span class="sc">~</span> <span class="st">"NONG BUA LAM PHU"</span>,</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> province_eng  <span class="co"># Keep other names unchanged</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the wide format data</span></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">head</span>(tourism_wide))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 10
  province_eng      date       ratio_tourist_stay no_tourist_stay no_tourist_all
  &lt;chr&gt;             &lt;date&gt;                  &lt;dbl&gt;           &lt;dbl&gt;          &lt;dbl&gt;
1 BANGKOK           2019-01-01               93.4         3334971        5959075
2 LOP BURI          2019-01-01               61.3           51858         268664
3 PHRA NAKHON SI A… 2019-01-01               73.4          117052         730329
4 SARABURI          2019-01-01               67.3           89850         207236
5 CHAI NAT          2019-01-01               79.3           27141          79073
6 NAKHON PATHOM     2019-01-01               71.7          118629         296107
# ℹ 5 more variables: no_tourist_thai &lt;dbl&gt;, no_tourist_foreign &lt;dbl&gt;,
#   revenue_all &lt;dbl&gt;, revenue_thai &lt;dbl&gt;, revenue_foreign &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section id="exploratory-spatial-data-analysis" class="level1">
<h1>Exploratory Spatial Data Analysis</h1>
<section id="what-data-do-we-have" class="level2">
<h2 class="anchored" data-anchor-id="what-data-do-we-have">What data do we have?</h2>
<ul>
<li><p>“ratio_tourist_stay”: Refers to the ratio of tourists who stay overnight.</p></li>
<li><p>“no_tourist_stay”: Refers to the number of tourists who stay overnight.</p></li>
<li><p>“no_tourist_all”: Refers to the total number of tourists.</p></li>
<li><p>“no_tourist_thai”: Refers to the number of domestic Thai tourists.</p></li>
<li><p>“no_tourist_foreign”: Refers to the number of foreign tourists.</p></li>
<li><p>“revenue_all”: Refers to total tourism revenue.</p></li>
<li><p>“revenue_thai”: Refers to revenue from domestic tourists.</p></li>
<li><p>“revenue_foreign”: Refers to revenue from foreign tourists.</p></li>
</ul>
</section>
<section id="join-data" class="level2">
<h2 class="anchored" data-anchor-id="join-data">Join data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate average values for each province across all time periods</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>tourism_summary <span class="ot">&lt;-</span> tourism_wide <span class="sc">%&gt;%</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(province_eng) <span class="sc">%&gt;%</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_ratio_tourist_stay =</span> <span class="fu">mean</span>(ratio_tourist_stay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_no_tourist_stay =</span> <span class="fu">mean</span>(no_tourist_stay, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_no_tourist_all =</span> <span class="fu">mean</span>(no_tourist_all, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_no_tourist_thai =</span> <span class="fu">mean</span>(no_tourist_thai, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_no_tourist_foreign =</span> <span class="fu">mean</span>(no_tourist_foreign, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_revenue_all =</span> <span class="fu">mean</span>(revenue_all, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_revenue_thai =</span> <span class="fu">mean</span>(revenue_thai, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">avg_revenue_foreign =</span> <span class="fu">mean</span>(revenue_foreign, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">pct_foreign_tourists =</span> <span class="fu">mean</span>(no_tourist_foreign <span class="sc">/</span> no_tourist_all <span class="sc">*</span> <span class="dv">100</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">pct_foreign_revenue =</span> <span class="fu">mean</span>(revenue_foreign <span class="sc">/</span> revenue_all <span class="sc">*</span> <span class="dv">100</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>tourism_summary <span class="ot">&lt;-</span> tourism_summary <span class="sc">%&gt;%</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">province_eng =</span> <span class="fu">case_when</span>(</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>    province_eng <span class="sc">==</span> <span class="st">"PHANG NGA"</span> <span class="sc">~</span> <span class="st">"PHANGNGA"</span>,</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>    province_eng <span class="sc">==</span> <span class="st">"LOPBURI"</span> <span class="sc">~</span> <span class="st">"LOP BURI"</span>,</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>    province_eng <span class="sc">==</span> <span class="st">"CHAINAT"</span> <span class="sc">~</span> <span class="st">"CHAI NAT"</span>,</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>    province_eng <span class="sc">==</span> <span class="st">"CHONBURI"</span> <span class="sc">~</span> <span class="st">"CHON BURI"</span>,</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>    province_eng <span class="sc">==</span> <span class="st">"PRACHINBURI"</span> <span class="sc">~</span> <span class="st">"PRACHIN BURI"</span>,</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>    province_eng <span class="sc">==</span> <span class="st">"BURIRAM"</span> <span class="sc">~</span> <span class="st">"BURI RAM"</span>,</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>    province_eng <span class="sc">==</span> <span class="st">"SISAKET"</span> <span class="sc">~</span> <span class="st">"SI SA KET"</span>,</span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>    province_eng <span class="sc">==</span> <span class="st">"NONG BUA LAMPHU"</span> <span class="sc">~</span> <span class="st">"NONG BUA LAM PHU"</span>,</span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> province_eng  <span class="co"># Keep other names unchanged</span></span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Join the summary data with the spatial data</span></span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>thailand_tourism <span class="ot">&lt;-</span> thailand_utm <span class="sc">%&gt;%</span></span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ADM1_EN =</span> <span class="fu">toupper</span>(ADM1_EN)) <span class="sc">%&gt;%</span></span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(tourism_summary, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"ADM1_EN"</span> <span class="ot">=</span> <span class="st">"province_eng"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="take-a-look-at-chloropleth-maps" class="level2">
<h2 class="anchored" data-anchor-id="take-a-look-at-chloropleth-maps">Take a look at chloropleth maps</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Map of average ratio of tourist stays</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(thailand_tourism) <span class="sc">+</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"avg_ratio_tourist_stay"</span>, </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"quantile"</span>, </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette =</span> <span class="st">"YlOrRd"</span>,</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"Avg. Ratio of Tourist Stays (%)"</span>) <span class="sc">+</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>() <span class="sc">+</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Average Ratio of Tourist Stays in Thailand"</span>,</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size =</span> <span class="fl">1.2</span>,</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.outside =</span> <span class="cn">TRUE</span>,</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.outside.position =</span> <span class="st">"right"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Map of average total revenue</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(thailand_tourism) <span class="sc">+</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"avg_revenue_all"</span>, </span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"quantile"</span>, </span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette =</span> <span class="st">"YlOrRd"</span>,</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"Avg. Total Revenue (Baht)"</span>) <span class="sc">+</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>() <span class="sc">+</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Average Total Tourism Revenue in Thailand"</span>,</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size =</span> <span class="fl">1.2</span>,</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.outside =</span> <span class="cn">TRUE</span>,</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.outside.position =</span> <span class="st">"right"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-5-2.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Map of percentage of foreign tourists</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(thailand_tourism) <span class="sc">+</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"pct_foreign_tourists"</span>, </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"quantile"</span>, </span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette =</span> <span class="st">"YlOrRd"</span>,</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"% Foreign Tourists"</span>) <span class="sc">+</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>() <span class="sc">+</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Percentage of Foreign Tourists in Thailand"</span>,</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size =</span> <span class="fl">1.2</span>,</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.outside =</span> <span class="cn">TRUE</span>,</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.outside.position =</span> <span class="st">"right"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-5-3.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Map of percentage of revenue from foreign tourists</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(thailand_tourism) <span class="sc">+</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"pct_foreign_revenue"</span>, </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"quantile"</span>, </span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette =</span> <span class="st">"YlOrRd"</span>,</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"% Revenue from Foreign Tourists"</span>) <span class="sc">+</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>() <span class="sc">+</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"% of Revenue from Foreign Tourists in Thailand"</span>,</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.position =</span> <span class="st">"center"</span>,</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size =</span> <span class="fl">1.2</span>,</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.outside =</span> <span class="cn">TRUE</span>,</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.outside.position =</span> <span class="st">"right"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-5-4.png" class="img-fluid" width="672"></p>
</div>
</div>
<ol type="1">
<li><p>Average Ratio of Tourist Stays in Thailand: This map shows the percentage of tourists who stay overnight in different regions of Thailand. The northern and central regions appear to have higher ratios of tourist stays (40-52%), indicated by the darker red colors. This suggests these areas may have more developed accommodation infrastructure or attractions that encourage longer visits. Coastal areas in the south show a mix of high and low stay ratios, possibly reflecting differences between popular beach resorts and transit areas.</p></li>
<li><p>Average Total Tourism Revenue in Thailand: The revenue map highlights significant disparities in tourism income across Thailand. Major tourist destinations like Bangkok, Phuket, and Chiang Mai (identifiable by the dark red areas) generate substantially higher revenues, ranging from 841 million to 36,939 million Baht. This concentration of revenue suggests a highly uneven distribution of tourism benefits across the country, with a few key areas dominating the industry.</p></li>
<li><p>Percentage of Foreign Tourists in Thailand: This map illustrates the distribution of international visitors. Coastal areas and major cities show the highest percentages of foreign tourists (9.23% to 45.51%), particularly in the south and around Bangkok. This pattern likely reflects the popularity of beach destinations and cultural sites among international travelers. Interior and northern regions generally have lower percentages of foreign visitors, suggesting a greater reliance on domestic tourism.</p></li>
<li><p>Percentage of Revenue from Foreign Tourists in Thailand: The revenue contribution from foreign tourists closely mirrors the distribution of foreign visitors. Coastal areas and major tourist hubs show the highest percentages (12.33% to 65.54%) of revenue from international visitors. This indicates that these regions not only attract more foreign tourists but also derive a significant portion of their tourism income from them. The pattern underscores the economic importance of international tourism to these areas and their potential vulnerability to global travel disruptions.</p></li>
</ol>
<p>These show an average of Thailand’s tourism landscape, possibly cluing us into regional disparities in tourist stays, overall revenue, and the role of international visitors in the country’s tourism economy.</p>
<p>Let’s take a look at the bar chart.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the histogram</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>mean_revenue <span class="ot">&lt;-</span> <span class="fu">mean</span>(tourism_summary<span class="sc">$</span>avg_revenue_all, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tourism_summary, <span class="fu">aes</span>(<span class="at">x =</span> avg_revenue_all)) <span class="sc">+</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">30</span>, <span class="at">fill =</span> <span class="st">"skyblue"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> mean_revenue, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> mean_revenue, <span class="at">y =</span> <span class="cn">Inf</span>, <span class="at">label =</span> <span class="st">"Mean"</span>, </span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">vjust =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Average Tourism Revenue Across Provinces"</span>,</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"Mean Revenue:"</span>, scales<span class="sc">::</span><span class="fu">comma</span>(mean_revenue)),</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Average Revenue (All)"</span>,</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>comma)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>mean_revenue_log <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">log</span>(tourism_summary<span class="sc">$</span>avg_revenue_all), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tourism_summary, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log</span>(avg_revenue_all))) <span class="sc">+</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">30</span>, <span class="at">fill =</span> <span class="st">"skyblue"</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> mean_revenue_log, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> mean_revenue_log, <span class="at">y =</span> <span class="cn">Inf</span>, <span class="at">label =</span> <span class="st">"Mean"</span>, </span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">vjust =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Log of Average Tourism Revenue Across Provinces"</span>,</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"Mean LogRevenue:"</span>, scales<span class="sc">::</span><span class="fu">comma</span>(mean_revenue_log)),</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Log of Average Revenue (All)"</span>,</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>comma)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-6-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Using log removes the skewness of the data and possibly can help us account for more of Thailand’s tourism activity. This accounts for the outlier that is Bangkok, which naturally gains more turism receipts than other provinces.</p>
</section>
</section>
<section id="global-morans-i-test" class="level1">
<h1>Global Moran’s I test</h1>
<p>Monte Carlo Moran’s I is a statistical technique used to assess whether the spatial pattern observed in data is significantly different from what would be expected by random chance alone.</p>
<p>In this analysis, I will perform Moran’s I test on both the average revenue (avg_revenue_all) and its logarithmic transformation (log(avg_revenue_all)) to gain a more comprehensive understanding of the spatial autocorrelation patterns in Thailand’s tourism revenue. This approach is taken because tourism revenue data has a skewed distribution, with a few provinces generating significantly higher revenues than others. By using the raw average revenue, we can identify spatial patterns in the absolute economic impact of tourism across provinces. However, this may be dominated by extreme values in high-revenue areas. The log transformation, on the other hand, helps to normalise the data distribution, reducing the impact of outliers and allowing us to detect spatial patterns in the relative differences of tourism performance across provinces. This transformation can reveal subtler spatial relationships that might be obscured in the raw data. The differing results between these two tests can provide insights into whether the spatial clustering is driven primarily by absolute revenue values or by proportional differences between provinces, offering a more nuanced view of the spatial dynamics in Thailand’s tourism economy.</p>
<p>First let’s test whether the average total revenue happened by random chance. To do so, we first need a contiguity matric. We’ll use queen’s contiguity.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate queen's contiguity</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>thailand_nb <span class="ot">&lt;-</span> <span class="fu">st_contiguity</span>(thailand_tourism, <span class="at">queen =</span> <span class="cn">TRUE</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Identify regions with no neighbors</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>no_neighbors <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">sapply</span>(thailand_nb, <span class="cf">function</span>(x) x[<span class="dv">1</span>] <span class="sc">==</span> <span class="dv">0</span>))</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>no_neighbors</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 67</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Manually add nearest neighbor for regions with no neighbors</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>thailand_nb[[<span class="dv">67</span>]] <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="dv">66</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>thailand_nb[[<span class="dv">66</span>]] <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">unique</span>(<span class="fu">c</span>(thailand_nb[[<span class="dv">66</span>]], <span class="dv">67</span>)))</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(thailand_nb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 77
 $ : int [1:6] 2 3 4 15 59 60
 $ : int [1:2] 1 15
 $ : int [1:4] 1 4 5 59
 $ : int [1:6] 1 3 5 10 15 17
 $ : int [1:7] 3 4 6 7 10 58 59
 $ : int [1:4] 5 7 8 58
 $ : int [1:8] 5 6 8 10 19 25 48 55
 $ : int [1:5] 6 7 9 48 58
 $ : int [1:4] 8 48 49 58
 $ : int [1:5] 4 5 7 17 19
 $ : int [1:3] 12 13 15
 $ : int [1:2] 11 13
 $ : int [1:5] 11 12 14 15 18
 $ : int 13
 $ : int [1:8] 1 2 4 11 13 16 17 18
 $ : int [1:4] 15 17 18 19
 $ : int [1:5] 4 10 15 16 19
 $ : int [1:5] 13 15 16 19 20
 $ : int [1:8] 7 10 16 17 18 20 25 29
 $ : int [1:5] 18 19 21 29 33
 $ : int [1:4] 20 22 33 34
 $ : int [1:4] 21 23 24 34
 $ : int [1:3] 22 24 26
 $ : int [1:5] 22 23 26 34 38
 $ : int [1:4] 7 19 29 55
 $ : int [1:3] 23 24 38
 $ : int [1:3] 32 36 37
 $ : int [1:3] 29 30 31
 $ : int [1:9] 19 20 25 28 30 31 33 35 55
 $ : int [1:6] 28 29 31 32 35 36
 $ : int [1:6] 28 29 30 32 53 55
 $ : int [1:4] 27 30 31 36
 $ : int [1:5] 20 21 29 34 35
 $ : int [1:6] 21 22 24 33 35 38
 $ : int [1:6] 29 30 33 34 36 38
 $ : int [1:6] 27 30 32 35 37 38
 $ : int [1:3] 27 36 38
 $ : int [1:6] 24 26 34 35 36 37
 $ : int [1:5] 40 41 46 47 51
 $ : int [1:3] 39 41 51
 $ : int [1:7] 39 40 43 45 46 51 52
 $ : int [1:4] 43 44 52 53
 $ : int [1:5] 41 42 44 45 52
 $ : int [1:3] 42 43 45
 $ : int [1:4] 41 43 44 46
 $ : int [1:3] 39 41 45
 $ : int [1:2] 39 51
 $ : int [1:8] 7 8 9 49 50 51 54 55
 $ : int [1:5] 9 48 51 57 58
 $ : int [1:5] 48 51 52 53 54
 $ : int [1:9] 39 40 41 47 48 49 50 52 57
 $ : int [1:6] 41 42 43 50 51 53
 $ : int [1:6] 31 42 50 52 54 55
 $ : int [1:4] 48 50 53 55
 $ : int [1:7] 7 25 29 31 48 53 54
 $ : int [1:5] 57 59 60 61 62
 $ : int [1:5] 49 51 56 58 59
 $ : int [1:7] 5 6 8 9 49 57 59
 $ : int [1:7] 1 3 5 56 57 58 60
 $ : int [1:4] 1 56 59 61
 $ : int [1:3] 56 60 62
 $ : int [1:3] 56 61 63
 $ : int [1:2] 62 70
 $ : int [1:5] 65 68 71 73 74
 $ : int [1:4] 64 66 68 73
 $ : int [1:4] 65 68 69 67
 $ : int 66
 $ : int [1:5] 64 65 66 69 70
 $ : int [1:3] 66 68 70
 $ : int [1:3] 63 68 69
 $ : int [1:5] 64 72 74 75 76
 $ : int [1:3] 71 73 74
 $ : int [1:4] 64 65 72 74
 $ : int [1:4] 64 71 72 73
 $ : int [1:3] 71 76 77
 $ : int [1:3] 71 75 77
 $ : int [1:2] 75 76
 - attr(*, "class")= chr [1:2] "nb" "list"
 - attr(*, "region.id")= chr [1:77] "1" "2" "3" "4" ...
 - attr(*, "call")= language spdep::poly2nb(pl = geometry, queen = queen)
 - attr(*, "type")= chr "queen"
 - attr(*, "sym")= logi TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Link Phuket to Phang Nga and vice versa because they are linked by bridge</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Check is still got empty</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>no_neighbors <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">sapply</span>(thailand_nb, <span class="cf">function</span>(x) x[<span class="dv">1</span>] <span class="sc">==</span> <span class="dv">0</span>))</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>no_neighbors</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>integer(0)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>thailand_weights <span class="ot">&lt;-</span> <span class="fu">st_weights</span>(thailand_nb, <span class="at">style =</span> <span class="st">"W"</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>wm_q <span class="ot">&lt;-</span> thailand_tourism <span class="sc">%&gt;%</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">nb =</span> thailand_nb,   </span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">wt =</span> thailand_weights,</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">.before =</span> <span class="dv">1</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Check the resulting structure</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(wm_q)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Classes 'sf' and 'data.frame':  77 obs. of  29 variables:
 $ nb                    :List of 77
  ..$ : int  2 3 4 15 59 60
  ..$ : int  1 15
  ..$ : int  1 4 5 59
  ..$ : int  1 3 5 10 15 17
  ..$ : int  3 4 6 7 10 58 59
  ..$ : int  5 7 8 58
  ..$ : int  5 6 8 10 19 25 48 55
  ..$ : int  6 7 9 48 58
  ..$ : int  8 48 49 58
  ..$ : int  4 5 7 17 19
  ..$ : int  12 13 15
  ..$ : int  11 13
  ..$ : int  11 12 14 15 18
  ..$ : int 13
  ..$ : int  1 2 4 11 13 16 17 18
  ..$ : int  15 17 18 19
  ..$ : int  4 10 15 16 19
  ..$ : int  13 15 16 19 20
  ..$ : int  7 10 16 17 18 20 25 29
  ..$ : int  18 19 21 29 33
  ..$ : int  20 22 33 34
  ..$ : int  21 23 24 34
  ..$ : int  22 24 26
  ..$ : int  22 23 26 34 38
  ..$ : int  7 19 29 55
  ..$ : int  23 24 38
  ..$ : int  32 36 37
  ..$ : int  29 30 31
  ..$ : int  19 20 25 28 30 31 33 35 55
  ..$ : int  28 29 31 32 35 36
  ..$ : int  28 29 30 32 53 55
  ..$ : int  27 30 31 36
  ..$ : int  20 21 29 34 35
  ..$ : int  21 22 24 33 35 38
  ..$ : int  29 30 33 34 36 38
  ..$ : int  27 30 32 35 37 38
  ..$ : int  27 36 38
  ..$ : int  24 26 34 35 36 37
  ..$ : int  40 41 46 47 51
  ..$ : int  39 41 51
  ..$ : int  39 40 43 45 46 51 52
  ..$ : int  43 44 52 53
  ..$ : int  41 42 44 45 52
  ..$ : int  42 43 45
  ..$ : int  41 43 44 46
  ..$ : int  39 41 45
  ..$ : int  39 51
  ..$ : int  7 8 9 49 50 51 54 55
  ..$ : int  9 48 51 57 58
  ..$ : int  48 51 52 53 54
  ..$ : int  39 40 41 47 48 49 50 52 57
  ..$ : int  41 42 43 50 51 53
  ..$ : int  31 42 50 52 54 55
  ..$ : int  48 50 53 55
  ..$ : int  7 25 29 31 48 53 54
  ..$ : int  57 59 60 61 62
  ..$ : int  49 51 56 58 59
  ..$ : int  5 6 8 9 49 57 59
  ..$ : int  1 3 5 56 57 58 60
  ..$ : int  1 56 59 61
  ..$ : int  56 60 62
  ..$ : int  56 61 63
  ..$ : int  62 70
  ..$ : int  65 68 71 73 74
  ..$ : int  64 66 68 73
  ..$ : int  65 68 69 67
  ..$ : int 66
  ..$ : int  64 65 66 69 70
  ..$ : int  66 68 70
  ..$ : int  63 68 69
  ..$ : int  64 72 74 75 76
  ..$ : int  71 73 74
  ..$ : int  64 65 72 74
  ..$ : int  64 71 72 73
  ..$ : int  71 76 77
  ..$ : int  71 75 77
  ..$ : int  75 76
  ..- attr(*, "class")= chr [1:2] "nb" "list"
  ..- attr(*, "region.id")= chr [1:77] "1" "2" "3" "4" ...
  ..- attr(*, "call")= language spdep::poly2nb(pl = geometry, queen = queen)
  ..- attr(*, "type")= chr "queen"
  ..- attr(*, "sym")= logi TRUE
 $ wt                    :List of 77
  ..$ : num  0.167 0.167 0.167 0.167 0.167 ...
  ..$ : num  0.5 0.5
  ..$ : num  0.25 0.25 0.25 0.25
  ..$ : num  0.167 0.167 0.167 0.167 0.167 ...
  ..$ : num  0.143 0.143 0.143 0.143 0.143 ...
  ..$ : num  0.25 0.25 0.25 0.25
  ..$ : num  0.125 0.125 0.125 0.125 0.125 0.125 0.125 0.125
  ..$ : num  0.2 0.2 0.2 0.2 0.2
  ..$ : num  0.25 0.25 0.25 0.25
  ..$ : num  0.2 0.2 0.2 0.2 0.2
  ..$ : num  0.333 0.333 0.333
  ..$ : num  0.5 0.5
  ..$ : num  0.2 0.2 0.2 0.2 0.2
  ..$ : num 1
  ..$ : num  0.125 0.125 0.125 0.125 0.125 0.125 0.125 0.125
  ..$ : num  0.25 0.25 0.25 0.25
  ..$ : num  0.2 0.2 0.2 0.2 0.2
  ..$ : num  0.2 0.2 0.2 0.2 0.2
  ..$ : num  0.125 0.125 0.125 0.125 0.125 0.125 0.125 0.125
  ..$ : num  0.2 0.2 0.2 0.2 0.2
  ..$ : num  0.25 0.25 0.25 0.25
  ..$ : num  0.25 0.25 0.25 0.25
  ..$ : num  0.333 0.333 0.333
  ..$ : num  0.2 0.2 0.2 0.2 0.2
  ..$ : num  0.25 0.25 0.25 0.25
  ..$ : num  0.333 0.333 0.333
  ..$ : num  0.333 0.333 0.333
  ..$ : num  0.333 0.333 0.333
  ..$ : num  0.111 0.111 0.111 0.111 0.111 ...
  ..$ : num  0.167 0.167 0.167 0.167 0.167 ...
  ..$ : num  0.167 0.167 0.167 0.167 0.167 ...
  ..$ : num  0.25 0.25 0.25 0.25
  ..$ : num  0.2 0.2 0.2 0.2 0.2
  ..$ : num  0.167 0.167 0.167 0.167 0.167 ...
  ..$ : num  0.167 0.167 0.167 0.167 0.167 ...
  ..$ : num  0.167 0.167 0.167 0.167 0.167 ...
  ..$ : num  0.333 0.333 0.333
  ..$ : num  0.167 0.167 0.167 0.167 0.167 ...
  ..$ : num  0.2 0.2 0.2 0.2 0.2
  ..$ : num  0.333 0.333 0.333
  ..$ : num  0.143 0.143 0.143 0.143 0.143 ...
  ..$ : num  0.25 0.25 0.25 0.25
  ..$ : num  0.2 0.2 0.2 0.2 0.2
  ..$ : num  0.333 0.333 0.333
  ..$ : num  0.25 0.25 0.25 0.25
  ..$ : num  0.333 0.333 0.333
  ..$ : num  0.5 0.5
  ..$ : num  0.125 0.125 0.125 0.125 0.125 0.125 0.125 0.125
  ..$ : num  0.2 0.2 0.2 0.2 0.2
  ..$ : num  0.2 0.2 0.2 0.2 0.2
  ..$ : num  0.111 0.111 0.111 0.111 0.111 ...
  ..$ : num  0.167 0.167 0.167 0.167 0.167 ...
  ..$ : num  0.167 0.167 0.167 0.167 0.167 ...
  ..$ : num  0.25 0.25 0.25 0.25
  ..$ : num  0.143 0.143 0.143 0.143 0.143 ...
  ..$ : num  0.2 0.2 0.2 0.2 0.2
  ..$ : num  0.2 0.2 0.2 0.2 0.2
  ..$ : num  0.143 0.143 0.143 0.143 0.143 ...
  ..$ : num  0.143 0.143 0.143 0.143 0.143 ...
  ..$ : num  0.25 0.25 0.25 0.25
  ..$ : num  0.333 0.333 0.333
  ..$ : num  0.333 0.333 0.333
  ..$ : num  0.5 0.5
  ..$ : num  0.2 0.2 0.2 0.2 0.2
  ..$ : num  0.25 0.25 0.25 0.25
  ..$ : num  0.25 0.25 0.25 0.25
  ..$ : num 1
  ..$ : num  0.2 0.2 0.2 0.2 0.2
  ..$ : num  0.333 0.333 0.333
  ..$ : num  0.333 0.333 0.333
  ..$ : num  0.2 0.2 0.2 0.2 0.2
  ..$ : num  0.333 0.333 0.333
  ..$ : num  0.25 0.25 0.25 0.25
  ..$ : num  0.25 0.25 0.25 0.25
  ..$ : num  0.333 0.333 0.333
  ..$ : num  0.333 0.333 0.333
  ..$ : num  0.5 0.5
  ..- attr(*, "mode")= chr "binary"
  ..- attr(*, "W")= logi TRUE
  ..- attr(*, "comp")=List of 1
  .. ..$ d: num [1:77] 6 2 4 6 7 4 8 5 4 5 ...
 $ Shape_Leng            : num  2.42 1.7 1.25 1.88 3.04 ...
 $ Shape_Area            : num  0.1313 0.0793 0.0532 0.127 0.2139 ...
 $ ADM1_EN               : chr  "BANGKOK" "SAMUT PRAKAN" "NONTHABURI" "PATHUM THANI" ...
 $ ADM1_TH               : chr  "กรุงเทพมหานคร" "สมุทรปราการ" "นนทบุรี" "ปทุมธานี" ...
 $ ADM1_PCODE            : chr  "TH10" "TH11" "TH12" "TH13" ...
 $ ADM1_REF              : chr  NA NA NA NA ...
 $ ADM1ALT1EN            : chr  NA NA NA NA ...
 $ ADM1ALT2EN            : chr  NA NA NA NA ...
 $ ADM1ALT1TH            : chr  NA NA NA NA ...
 $ ADM1ALT2TH            : chr  NA NA NA NA ...
 $ ADM0_EN               : chr  "Thailand" "Thailand" "Thailand" "Thailand" ...
 $ ADM0_TH               : chr  "ประเทศไทย" "ประเทศไทย" "ประเทศไทย" "ประเทศไทย" ...
 $ ADM0_PCODE            : chr  "TH" "TH" "TH" "TH" ...
 $ date                  : Date, format: "2019-02-18" "2019-02-18" ...
 $ validOn               : Date, format: "2022-01-22" "2022-01-22" ...
 $ validTo               : Date, format: "-001-11-30" "-001-11-30" ...
 $ avg_ratio_tourist_stay: num  43.8 32 36.4 28.6 42.8 ...
 $ avg_no_tourist_stay   : num  1508737 48607 48158 24805 60806 ...
 $ avg_no_tourist_all    : num  3027050 162207 157251 106477 476473 ...
 $ avg_no_tourist_thai   : num  2137997 118545 149184 91470 417236 ...
 $ avg_no_tourist_foreign: num  889053 43662 8067 15007 59237 ...
 $ avg_revenue_all       : num  3.69e+10 2.81e+08 2.24e+08 1.53e+08 8.76e+08 ...
 $ avg_revenue_thai      : num  1.48e+10 1.81e+08 2.06e+08 1.22e+08 7.16e+08 ...
 $ avg_revenue_foreign   : num  2.21e+10 9.94e+07 1.80e+07 3.14e+07 1.60e+08 ...
 $ pct_foreign_tourists  : num  22.34 17.64 3.6 8.73 9.35 ...
 $ pct_foreign_revenue   : num  44.95 21.07 5.06 11.56 12.53 ...
 $ geometry              :sfc_MULTIPOLYGON of length 77; first list element: List of 1
  ..$ :List of 1
  .. ..$ : num [1:8501, 1:2] 674340 674382 674449 674458 674467 ...
  ..- attr(*, "class")= chr [1:3] "XY" "MULTIPOLYGON" "sfg"
 - attr(*, "sf_column")= chr "geometry"
 - attr(*, "agr")= Factor w/ 3 levels "constant","aggregate",..: NA NA NA NA NA NA NA NA NA NA ...
  ..- attr(*, "names")= chr [1:28] "nb" "wt" "Shape_Leng" "Shape_Area" ...</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform Monte Carlo simulation for Moran's I</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>mc_moran <span class="ot">&lt;-</span> <span class="fu">global_moran_test</span>(</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">log</span>(thailand_tourism<span class="sc">$</span>avg_revenue_all),</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  thailand_nb,</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  thailand_weights</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the results</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(mc_moran)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Moran I test under randomisation

data:  x  
weights: listw    

Moran I statistic standard deviate = 2.8404, p-value = 0.002253
alternative hypothesis: greater
sample estimates:
Moran I statistic       Expectation          Variance 
      0.204345202      -0.013157895       0.005863852 </code></pre>
</div>
</div>
<ol type="1">
<li><p>Moran’s I statistic is close to zero, suggesting weak spatial autocorrelation. A value of -1 indicates perfect dispersion, +1 indicates perfect correlation, and 0 indicates a random spatial pattern.</p></li>
<li><p>p-value is &gt; 0.05. This indicates that we fail to reject the null hypothesis of spatial randomness. There is no significant evidence of positive spatial autocorrelation in average total revenue across Thailand’s provinces. The spatial pattern of tourism revenue appears to be randomly distributed, rather than clustered or dispersed.</p></li>
</ol>
<p>Let’s take a look at Monte Carlo Simluation</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>mc_moran_sim <span class="ot">&lt;-</span> <span class="fu">global_moran_perm</span>(</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  thailand_tourism<span class="sc">$</span>avg_revenue_all,</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  thailand_nb,</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  thailand_weights,</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">nsim =</span> <span class="dv">999</span>  <span class="co"># number of simulations</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the results</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(mc_moran_sim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Monte-Carlo simulation of Moran I

data:  x 
weights: listw  
number of simulations + 1: 1000 

statistic = -0.030518, observed rank = 464, p-value = 0.928
alternative hypothesis: two.sided</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Visualize the results</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(mc_moran_sim<span class="sc">$</span>res, </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">freq =</span> <span class="cn">TRUE</span>, </span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">breaks =</span> <span class="dv">20</span>, </span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Moran's I"</span>, </span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Histogram of simulated Moran's I"</span>)</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>It appears that findings are similar to that one the single test.</p>
<p>This suggests that high or low tourism revenue in one province does not necessarily correspond to similar values in neighboring provinces. The economic performance of the tourism sector in each province seems to be independent of its geographical location relative to other provinces. This may be because tourism doesn’t spread out from the popular places. Rather, if tourists are interested in surrounding areas, they would fly straight to that destination.</p>
<p>Or this could be because we used average revenue. Let’s take a look at logged value.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform Monte Carlo simulation for Moran's I</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>mc_moran <span class="ot">&lt;-</span> <span class="fu">global_moran_test</span>(</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">log</span>(thailand_tourism<span class="sc">$</span>avg_revenue_all),</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  thailand_nb,</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  thailand_weights</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the results</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(mc_moran)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Moran I test under randomisation

data:  x  
weights: listw    

Moran I statistic standard deviate = 2.8404, p-value = 0.002253
alternative hypothesis: greater
sample estimates:
Moran I statistic       Expectation          Variance 
      0.204345202      -0.013157895       0.005863852 </code></pre>
</div>
</div>
<p>Moran’s I statistic is positive. It indicates a positive spatial autocorrelation. It suggests that similar values (either high or low) of average revenue tend to cluster together geographically more than would be expected by chance.</p>
<p>p-value is below the significance level of 0.05. It indicates strong evidence against the null hypothesis of spatial randomness. In other words, the spatial pattern observed is very unlikely to have occurred by chance.</p>
<p>The results provide strong evidence of positive spatial autocorrelation in the log-transformed average tourism revenue across Thailand’s provinces. This means that provinces with high tourism revenues tend to be located near other provinces with high revenues, and provinces with low revenues tend to be near other low-revenue provinces.</p>
<p>Let’s try applying this to the change in revenue from Jul 2021 (trough of revenue) and Jan 2023 (one of the peaks in revenue).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>revenue_comparison <span class="ot">&lt;-</span> tourism_wide <span class="sc">%&gt;%</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(date <span class="sc">%in%</span> <span class="fu">c</span>(<span class="fu">as.Date</span>(<span class="st">"2021-07-01"</span>), <span class="fu">as.Date</span>(<span class="st">"2023-01-01"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(province_eng, date, revenue_all) <span class="sc">%&gt;%</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> date, <span class="at">values_from =</span> revenue_all, <span class="at">names_prefix =</span> <span class="st">"revenue_"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">delta_jul21_jan23 =</span> <span class="st">`</span><span class="at">revenue_2023-01-01</span><span class="st">`</span> <span class="sc">-</span> <span class="st">`</span><span class="at">revenue_2021-07-01</span><span class="st">`</span>,</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">province_eng =</span> <span class="fu">toupper</span>(province_eng)</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(province_eng, delta_jul21_jan23)</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Now, let's join this new data to our existing thailand_tourism dataframe</span></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>thailand_tourism_diff <span class="ot">&lt;-</span> thailand_tourism <span class="sc">%&gt;%</span></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(revenue_comparison, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"ADM1_EN"</span> <span class="ot">=</span> <span class="st">"province_eng"</span>))</span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>mc_moran_diff <span class="ot">&lt;-</span> <span class="fu">global_moran_perm</span>(</span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a>  thailand_tourism_diff<span class="sc">$</span>delta_jul21_jan23,</span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a>  thailand_nb,</span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>  thailand_weights,</span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">nsim=</span><span class="dv">999</span></span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the results</span></span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(mc_moran_diff)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Monte-Carlo simulation of Moran I

data:  x 
weights: listw  
number of simulations + 1: 1000 

statistic = -0.039269, observed rank = 280, p-value = 0.56
alternative hypothesis: two.sided</code></pre>
</div>
</div>
<p>Based on these results, there is no significant evidence of spatial autocorrelation in the changes in tourism revenue across Thailand’s provinces between July 2021 and January 2023. The spatial pattern of revenue changes appears to be randomly distributed, rather than clustered or dispersed.</p>
<p>This suggests that the recovery (or changes) in tourism revenue from July 2021 to January 2023 was not geographically dependent. Neighboring provinces did not necessarily experience similar trends in revenue changes. It could be possible that during recovery, tourists flocked to popular places first. The tourism dollars did not spill into neighbouring provinces.</p>
</section>
<section id="local-indicators-of-spatial-association" class="level1">
<h1>Local Indicators of Spatial Association</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>lisa <span class="ot">&lt;-</span> thailand_tourism_diff <span class="sc">%&gt;%</span> </span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">local_moran =</span> <span class="fu">local_moran</span>(</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>    thailand_tourism_diff<span class="sc">$</span>avg_revenue_all,</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>    thailand_nb, </span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>    thailand_weights, </span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">nsim =</span> <span class="dv">99</span>,),</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(local_moran)</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>tmap mode set to plotting</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>localMI.ii <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(lisa) <span class="sc">+</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"ii"</span>, </span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"pretty"</span>, </span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"local Moran's I of Revenue"</span>) <span class="sc">+</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>localMI.p_ii <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(lisa) <span class="sc">+</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"p_ii"</span>, </span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">breaks=</span><span class="fu">c</span>(<span class="sc">-</span><span class="cn">Inf</span>, <span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="cn">Inf</span>),</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette=</span><span class="st">"-Blues"</span>, </span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"local Moran's I of Revenue"</span>) <span class="sc">+</span></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(localMI.ii, localMI.p_ii, <span class="at">asp=</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Variable(s) "ii" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Most provinces shows values between -0.5 and 0.5 (yellow to light green), indicating weak spatial autocorrelation. But there is a notable red area in the central region (Bangkok and surrounding provinces) with values between -2.0 to -1.5, suggesting strong negative spatial autocorrelation.</p>
<p>The blue map shows the statistical significance of the Local Moran’s I values. A cluster of dark blue areas (p &lt; 0.001) is visible in the central region, corresponding to thearea surrounding the red area in the yellow map. Most other areas are light blue or white, indicating less significant or non-significant results.</p>
<p>Bangkok shows strong, statistically significant negative spatial autocorrelation. This suggests that this area’s revenue is significantly different from its neighbors. This might be a Low-High Cluster. The strong negative values in Bangkok, combined with high statistical significance, suggest this area might be a “low-high” cluster - an area with low values surrounded by high values (or vice versa).</p>
<p>Similarly, we should take a look at the normalised values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>lisa <span class="ot">&lt;-</span> thailand_tourism_diff <span class="sc">%&gt;%</span> </span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">local_moran =</span> <span class="fu">local_moran</span>(</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">log</span>(thailand_tourism_diff<span class="sc">$</span>avg_revenue_all),</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>    thailand_nb, </span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>    thailand_weights, </span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">nsim =</span> <span class="dv">99</span>,),</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(local_moran)</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>tmap mode set to plotting</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>localMI.ii <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(lisa) <span class="sc">+</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"ii"</span>, </span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"pretty"</span>, </span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"local Moran's I of Revenue"</span>) <span class="sc">+</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>localMI.p_ii <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(lisa) <span class="sc">+</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"p_ii"</span>, </span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">breaks=</span><span class="fu">c</span>(<span class="sc">-</span><span class="cn">Inf</span>, <span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="cn">Inf</span>),</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette=</span><span class="st">"-Blues"</span>, </span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"local Moran's I of Revenue"</span>) <span class="sc">+</span></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(localMI.ii, localMI.p_ii, <span class="at">asp=</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Variable(s) "ii" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The log-transformed revenue data reveals more nuanced spatial patterns compared to the raw revenue data. This suggests that relative differences in tourism revenue between neighboring provinces are important. High-High Clusters: The northeastern region shows signs of positive autocorrelation with high significance. This could indicate a cluster of provinces with similarly high (relative to their scale) tourism revenues. Low-Low Clusters: Some central and southern provinces show negative autocorrelation, which might represent clusters of provinces with lower tourism revenues relative to their neighbors.</p>
<p>The eastern seaboard’s significant results suggest a distinct tourism pattern in this region, possibly related to coastal and industrial tourism.</p>
<p>This analysis reveals that the spatial patterns of tourism revenue in Thailand are more complex when considering relative performance rather than absolute values.</p>
</section>
<section id="hot-spot-and-cold-spot-area-analysis-hcsa" class="level1">
<h1><strong>Hot Spot and Cold Spot Area Analysis (HCSA)</strong></h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>gi_stars <span class="ot">&lt;-</span> thailand_tourism_diff <span class="sc">%&gt;%</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">gi_star =</span> <span class="fu">local_g_perm</span>(</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">log</span>(avg_revenue_all),</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">nb =</span> thailand_nb,</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">wt =</span> thailand_weights,</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>      <span class="at">nsim =</span> <span class="dv">999</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(gi_star)</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>gistarplot <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(gi_stars) <span class="sc">+</span></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(</span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">"gi"</span>,</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span> <span class="st">"pretty"</span>,</span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">palette =</span> <span class="st">"-RdBu"</span>,</span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">midpoint =</span> <span class="dv">0</span>,</span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Gi* Statistic"</span></span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(</span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">main.title =</span> <span class="st">"Hot Spot and Cold Spot Analysis of Tourism Revenue"</span>,</span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">main.title.size =</span> <span class="fl">0.8</span></span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a>gistarpplot<span class="ot">&lt;-</span><span class="fu">tm_shape</span>(gi_stars) <span class="sc">+</span></span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(</span>
<span id="cb51-28"><a href="#cb51-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">"p_value"</span>,</span>
<span id="cb51-29"><a href="#cb51-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="cn">Inf</span>, <span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="cn">Inf</span>),</span>
<span id="cb51-30"><a href="#cb51-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">palette =</span> <span class="st">"-Blues"</span>,</span>
<span id="cb51-31"><a href="#cb51-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"p-value of Gi*"</span></span>
<span id="cb51-32"><a href="#cb51-32" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb51-33"><a href="#cb51-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb51-34"><a href="#cb51-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(</span>
<span id="cb51-35"><a href="#cb51-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">main.title =</span> <span class="st">"Significance of Hot and Cold Spots"</span>,</span>
<span id="cb51-36"><a href="#cb51-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">main.title.size =</span> <span class="fl">0.8</span></span>
<span id="cb51-37"><a href="#cb51-37" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb51-38"><a href="#cb51-38" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(gistarplot, gistarpplot, <span class="at">asp=</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Let’s analyse the Hot Spot and Cold Spot Analysis (HCSA) maps for tourism revenue in Thailand.</p>
<p>Northeastern sees a large cluster of dark blue provinces, indicating a significant cold spot (low values clustered together). Central region (including Bangkok): Shows a mix of red and blue, indicating a complex pattern of hot and cold spots. Southern region: Exhibits mostly orange to red colors, suggesting potential hot spots, especially in popular tourist destinations.</p>
<p>Many provinces, especially in the north and west, show less significant or non-significant results (light blue to white).</p>
<p>Northeastern Cold Spot is a large, statistically significant cold spot that suggests that this region consistently underperforms in tourism revenue compared to the other provinces. This could be due to less developed tourism infrastructure or fewer popular attractions. Eastern Seaboard Hot Spot is a significant hot spot indicating a cluster of high-performing provinces in terms of tourism revenue. This could be attributed to popular beach destinations, well-developed infrastructure, or proximity to Bangkok. Bangkok and Central Region has a mixed pattern around Bangkok suggests a complex tourism landscape, possibly reflecting the capital’s unique position and its impact on surrounding areas. Southern Tourism Strength: The tendency towards hot spots in the south, although with varying significance, aligns with the popularity of southern beach destinations. The clustering of significant results confirms that tourism performance is indeed spatially dependent, with neighboring provinces often showing similar patterns.</p>
</section>
<section id="emerging-hot-spot-cold-spot-analysis" class="level1">
<h1>Emerging hot spot cold spot analysis</h1>
<p>While the Hot Spot and Cold Spot Analysis (HCSA) provides valuable insights into the spatial patterns of Thailand’s tourism revenue, it offers only a static snapshot of the situation. This approach, though informative, is insufficient for capturing the dynamic nature of the tourism industry, especially in the context of recovering from the COVID-19 pandemic. Tourism patterns can change significantly over time due to factors such as seasonality, economic fluctuations, policy changes, and global events. The emerging hot spot analysis addresses this limitation by incorporating a temporal dimension into our spatial analysis. By creating a space-time cube, we can examine how tourism revenue patterns have evolved over different time periods. This approach allows us to identify not just areas of high or low performance, but also emerging trends, such as areas that are becoming increasingly popular (emerging hot spots) or those experiencing declining tourism activity (emerging cold spots). Such temporal-spatial analysis is particularly crucial in the post-pandemic context, as it can reveal which areas are recovering faster, which are struggling to regain their tourism momentum, and where new tourism patterns might be emerging. This dynamic view is essential for policymakers and stakeholders in developing adaptive strategies that respond to the changing landscape of Thailand’s tourism industry.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>tourism_log <span class="ot">&lt;-</span> tourism_wide <span class="sc">%&gt;%</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">revenue_all =</span> <span class="fu">if_else</span>(revenue_all <span class="sc">==</span> <span class="dv">0</span>, <span class="dv">1</span>, revenue_all)) <span class="sc">%&gt;%</span> <span class="co">#change zeroes to 1 to have a full log</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">log_revenue_all =</span> <span class="fu">log</span>(revenue_all))</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Create running month column</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>tourism_log_time <span class="ot">&lt;-</span> tourism_log <span class="sc">%&gt;%</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">running_month =</span> (<span class="fu">as.numeric</span>(<span class="fu">format</span>(date, <span class="st">"%Y"</span>)) <span class="sc">-</span> <span class="dv">2019</span>) <span class="sc">*</span> <span class="dv">12</span> <span class="sc">+</span> <span class="fu">as.numeric</span>(<span class="fu">format</span>(date, <span class="st">"%m"</span>)),</span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">year =</span> <span class="fu">year</span>(date),</span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">month =</span> <span class="fu">month</span>(date),</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">day =</span> <span class="fu">day</span>(date) </span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">ADM1_EN=</span>province_eng)</span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a>tourism_spacetime <span class="ot">&lt;-</span> <span class="fu">spacetime</span>(tourism_log_time, thailand_utm,</span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a>                      <span class="at">.loc_col =</span> <span class="st">"ADM1_EN"</span>,</span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a>                      <span class="at">.time_col =</span> <span class="st">"running_month"</span>)</span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a><span class="fu">is_spacetime_cube</span>(tourism_spacetime)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<p>In this code segment, I am preparing the tourism data for a spatio-temporal analysis. First, I modify the ‘revenue_all’ column by replacing any zero values with 1. This is done to avoid undefined results when taking the logarithm, as log(0) is undefined. Revenue of 1 is as good as 0 as it is in Thai Baht. I then create a new column ‘log_revenue_all’ by applying a logarithmic transformation to the modified revenue data. This transformation helps to normalize the revenue distribution, which is often skewed in economic data.</p>
<p>Next, I create a ‘running_month’ column to establish a consistent time scale across the dataset. This column represents the number of months since January 2019, allowing for a uniform temporal measure. I also extract separate columns for year, month, and day from the date column for potential additional analyses.</p>
<p>Finally, I use the ‘spacetime’ function to create a spatio-temporal cube, combining the temporal data from ‘tourism_log_time’ with the spatial data from ‘thailand_utm’. This cube structure allows me to analyze how tourism revenue changes both across different provinces (space) and over time. The ‘is_spacetime_cube’ function is then used to verify that the resulting object is indeed a valid spatio-temporal cube, ensuring that my data is correctly formatted for subsequent spatio-temporal analyses.</p>
<section id="computing-gi" class="level2">
<h2 class="anchored" data-anchor-id="computing-gi">Computing Gi*</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>tourism_spacetime_nb <span class="ot">&lt;-</span> tourism_spacetime <span class="sc">%&gt;%</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(<span class="st">"geometry"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">nb =</span> <span class="fu">include_self</span>(</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">st_contiguity</span>(geometry)),</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">wt =</span> <span class="fu">st_inverse_distance</span>(nb, </span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>                             geometry, </span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>                             <span class="at">scale =</span> <span class="dv">1</span>,</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>                             <span class="at">alpha =</span> <span class="dv">1</span>),</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">.before =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_nbs</span>(<span class="st">"nb"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set_wts</span>(<span class="st">"wt"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>! Polygon provided. Using point on surface.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Computing Gi*</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>gi_stars <span class="ot">&lt;-</span> tourism_spacetime_nb <span class="sc">%&gt;%</span> </span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(running_month) <span class="sc">%&gt;%</span> </span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">gi_star =</span> <span class="fu">local_gstar_perm</span>(</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>    log_revenue_all , nb, wt)) <span class="sc">%&gt;%</span> </span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">unnest</span>(gi_star)</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Mann-Kendall Test on Gi*</span></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>gistars_bkk <span class="ot">&lt;-</span> gi_stars <span class="sc">%&gt;%</span> </span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ADM1_EN <span class="sc">==</span> <span class="st">"BANGKOK"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ADM1_EN, running_month, gi_star)</span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> gistars_bkk, </span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> running_month, </span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> gi_star)) <span class="sc">+</span></span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>()</span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-4310862eb67279a4802f" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-4310862eb67279a4802f">{"x":{"data":[{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50],"y":[1.7242455835383612,1.7674447584103394,1.7716571894763404,1.9785089509115568,2.0799473924206282,2.085746155761171,2.3529136788408183,2.415696988570093,2.3195956136115594,2.0228727287559192,2.1276774207960045,2.0386787687987917,1.7371337169064549,1.436247529740488,0.92200123430353742,-0.081953198189587725,-0.16466869505601633,1.9091043456898009,1.3983733672215488,1.8208348871177211,1.7682258886395623,1.4953134613070405,1.7713699875356761,1.087428591811618,-0.89625373075116954,1.3978253763655273,0.92145705104520703,0.33462385170442971,0.75981375340539692,0.25661717337176287,-0.13914918711767307,0.064515622018367594,1.3844945981459846,1.8205247065945052,1.3612344394878584,1.7768827449697626,1.5603279085079398,1.5078703334667778,1.7204375425476306,1.7220794780388122,1.7179697892152543,1.8025724815815494,1.9333990660846279,1.994193095759333,2.0447867143230392,2.0268783250755043,2.2296178640841684,2.153421845987249,2.1664261645739269,2.1046615650993066],"text":["running_month:  1<br />gi_star:  1.72424558","running_month:  2<br />gi_star:  1.76744476","running_month:  3<br />gi_star:  1.77165719","running_month:  4<br />gi_star:  1.97850895","running_month:  5<br />gi_star:  2.07994739","running_month:  6<br />gi_star:  2.08574616","running_month:  7<br />gi_star:  2.35291368","running_month:  8<br />gi_star:  2.41569699","running_month:  9<br />gi_star:  2.31959561","running_month: 10<br />gi_star:  2.02287273","running_month: 11<br />gi_star:  2.12767742","running_month: 12<br />gi_star:  2.03867877","running_month: 13<br />gi_star:  1.73713372","running_month: 14<br />gi_star:  1.43624753","running_month: 15<br />gi_star:  0.92200123","running_month: 16<br />gi_star: -0.08195320","running_month: 17<br />gi_star: -0.16466870","running_month: 18<br />gi_star:  1.90910435","running_month: 19<br />gi_star:  1.39837337","running_month: 20<br />gi_star:  1.82083489","running_month: 21<br />gi_star:  1.76822589","running_month: 22<br />gi_star:  1.49531346","running_month: 23<br />gi_star:  1.77136999","running_month: 24<br />gi_star:  1.08742859","running_month: 25<br />gi_star: -0.89625373","running_month: 26<br />gi_star:  1.39782538","running_month: 27<br />gi_star:  0.92145705","running_month: 28<br />gi_star:  0.33462385","running_month: 29<br />gi_star:  0.75981375","running_month: 30<br />gi_star:  0.25661717","running_month: 31<br />gi_star: -0.13914919","running_month: 32<br />gi_star:  0.06451562","running_month: 33<br />gi_star:  1.38449460","running_month: 34<br />gi_star:  1.82052471","running_month: 35<br />gi_star:  1.36123444","running_month: 36<br />gi_star:  1.77688274","running_month: 37<br />gi_star:  1.56032791","running_month: 38<br />gi_star:  1.50787033","running_month: 39<br />gi_star:  1.72043754","running_month: 40<br />gi_star:  1.72207948","running_month: 41<br />gi_star:  1.71796979","running_month: 42<br />gi_star:  1.80257248","running_month: 43<br />gi_star:  1.93339907","running_month: 44<br />gi_star:  1.99419310","running_month: 45<br />gi_star:  2.04478671","running_month: 46<br />gi_star:  2.02687833","running_month: 47<br />gi_star:  2.22961786","running_month: 48<br />gi_star:  2.15342185","running_month: 49<br />gi_star:  2.16642616","running_month: 50<br />gi_star:  2.10466157"],"type":"scatter","mode":"lines","line":{"width":1.8897637795275593,"color":"rgba(0,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":26.228310502283104,"r":7.3059360730593621,"b":40.182648401826491,"l":37.260273972602747},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-1.4500000000000002,52.450000000000003],"tickmode":"array","ticktext":["0","10","20","30","40","50"],"tickvals":[0,10,20,30,40,50],"categoryorder":"array","categoryarray":["0","10","20","30","40","50"],"nticks":null,"ticks":"outside","tickcolor":"rgba(179,179,179,1)","ticklen":3.6529680365296811,"tickwidth":0.33208800332088001,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(222,222,222,1)","gridwidth":0.33208800332088001,"zeroline":false,"anchor":"y","title":{"text":"running_month","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-1.0618512667172326,2.581294524536156],"tickmode":"array","ticktext":["-1","0","1","2"],"tickvals":[-1,0,1,2],"categoryorder":"array","categoryarray":["-1","0","1","2"],"nticks":null,"ticks":"outside","tickcolor":"rgba(179,179,179,1)","ticklen":3.6529680365296811,"tickwidth":0.33208800332088001,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.68949771689498},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(222,222,222,1)","gridwidth":0.33208800332088001,"zeroline":false,"anchor":"x","title":{"text":"gi_star","font":{"color":"rgba(0,0,0,1)","family":"","size":14.611872146118724}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":"transparent","line":{"color":"rgba(179,179,179,1)","width":0.66417600664176002,"linetype":"solid"},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.8897637795275593,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.68949771689498}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"5de447f224a3":{"x":{},"y":{},"type":"scatter"}},"cur_data":"5de447f224a3","visdat":{"5de447f224a3":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>The Gi* plot for Bangkok reveals tourism revenue trends over time. Initially, Bangkok stood as a significant hot spot, with the trend strengthening until around month 10. A slight decline followed, but Bangkok maintained its hot spot status until a sharp downturn around month 15, likely marking the onset of the COVID-19 pandemic. This period saw Bangkok’s performance drop to average or below-average levels compared to surrounding areas. The subsequent months were characterized by volatility, with sharp fluctuations possibly reflecting various recovery attempts and pandemic waves. A notable dip around month 25 temporarily turned Bangkok into a cold spot. However, from month 30 onwards, a steady upward trend emerged, indicating Bangkok’s gradual recovery. By the end of the period, Bangkok had largely reclaimed its pre-pandemic status as a significant hot spot for tourism revenue.</p>
</section>
<section id="man-kendall-test" class="level2">
<h2 class="anchored" data-anchor-id="man-kendall-test">Man Kendall Test</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>gistars_bkk <span class="sc">%&gt;%</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mk =</span> <span class="fu">list</span>(</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unclass</span>(</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>      Kendall<span class="sc">::</span><span class="fu">MannKendall</span>(gi_star)))) <span class="sc">%&gt;%</span> </span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">unnest_wider</span>(mk)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 5
     tau    sl     S     D   varS
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
1 0.0188 0.854    23  1225 14292.</code></pre>
</div>
</div>
<p>This Mann-Kendall test result provides insights into the trend of the Gi* statistic for Bangkok over time. The tau value indicates a very weak positive trend, suggesting a slight overall increase in Bangkok’s status as a hot spot for tourism revenue. The p-value (represented by ‘sl’ in the table) of 0.8539923 is much higher than the typical significance threshold of 0.05, indicating that this trend is not statistically significant. In other words, while there’s a slight positive trend in Bangkok’s tourism performance relative to its neighbors over time, this trend is not strong enough to rule out the possibility that it occurred by chance. This could be because of the period during covid which is part of the observation.</p>
</section>
<section id="emerging-hot-spot-and-cold-spot" class="level2">
<h2 class="anchored" data-anchor-id="emerging-hot-spot-and-cold-spot">Emerging hot spot and cold spot</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform Emerging Hot Spot Analysis</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>ehsa <span class="ot">&lt;-</span> <span class="fu">emerging_hotspot_analysis</span>(</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> tourism_spacetime, </span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">.var =</span> <span class="st">"log_revenue_all"</span>, </span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">k =</span> <span class="dv">1</span>, </span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">nsim =</span> <span class="dv">99</span></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a bar plot of classifications</span></span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> ehsa,</span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> classification)) <span class="sc">+</span></span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>() <span class="sc">+</span></span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of EHSA Classifications"</span>,</span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Classification"</span>,</span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Count"</span>) <span class="sc">+</span></span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Join EHSA results with spatial data</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>thailand_ehsa <span class="ot">&lt;-</span> thailand_utm <span class="sc">%&gt;%</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(ehsa,</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"ADM1_EN"</span> <span class="ot">=</span> <span class="st">"location"</span>))</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter for significant results</span></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>ehsa_sig <span class="ot">&lt;-</span> thailand_ehsa <span class="sc">%&gt;%</span></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(p_value <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a map</span></span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>tmap mode set to plotting</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(thailand_ehsa) <span class="sc">+</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="at">col =</span> <span class="st">"grey90"</span>, <span class="at">border.col =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(ehsa_sig) <span class="sc">+</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="st">"classification"</span>, </span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette =</span> <span class="st">"viridis"</span>, </span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"EHSA Classification"</span>) <span class="sc">+</span> </span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="at">main.title =</span> <span class="st">"Emerging Hot Spots of Tourism Revenue in Thailand"</span>,</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.position =</span> <span class="fu">c</span>(<span class="st">"center"</span>, <span class="st">"top"</span>),</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">main.title.size =</span> <span class="dv">1</span>,</span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.outside =</span> <span class="cn">TRUE</span>,</span>
<span id="cb62-12"><a href="#cb62-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.outside.position =</span> <span class="st">"right"</span>,</span>
<span id="cb62-13"><a href="#cb62-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">frame =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb62-14"><a href="#cb62-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_compass</span>(<span class="at">type =</span> <span class="st">"8star"</span>, <span class="at">position =</span> <span class="fu">c</span>(<span class="st">"right"</span>, <span class="st">"top"</span>)) <span class="sc">+</span></span>
<span id="cb62-15"><a href="#cb62-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_scale_bar</span>(<span class="at">position =</span> <span class="fu">c</span>(<span class="st">"left"</span>, <span class="st">"bottom"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-18-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The overall pattern points to a varied tourism landscape in Thailand:</p>
<ul>
<li><p>The lack of pattern in many inland areas might indicate a more stable, possibly domestic-oriented tourism sector less affected by international trends.</p></li>
<li><p>The sporadic nature of both hot and cold spots in various regions highlights the complex and changing nature of Thailand’s tourism industry, possibly influenced by factors such as covid.</p></li>
</ul>
</section>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
<p>This study provided valuable insights into the spatial and temporal dynamics of the industry, particularly in the context of the COVID-19 pandemic. Through various spatial statistical analyses, including Global and Local Moran’s I tests, Hot Spot and Cold Spot Analysis, and Emerging Hot Spot Analysis, the study uncovered patterns of tourism revenue distribution across Thailand’s provinces. The results reveal significant regional disparities, with areas like Bangkok and the eastern seaboard consistently emerging as hot spots, while the northeastern region remains a persistent cold spot. Interestingly, the impact of COVID-19 and the subsequent recovery appear to have affected different regions in diverse ways, highlighting the non-uniform nature of the tourism industry’s resilience. The temporal analysis, in particular, shed light on the evolving patterns of tourism revenue, demonstrating how some areas rapidly regained their status as tourism hot spots while others struggled to recover. These findings underscore the importance of tailored, region-specific strategies for tourism development and recovery. As Thailand continues to navigate the post-pandemic landscape, this analysis provides a foundation for policymakers and stakeholders to make informed decisions, potentially leading to more resilient and equitable growth in the country’s vital tourism sector.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>