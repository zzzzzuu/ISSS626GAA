---
title: "In-class Exercise 4"
author: "Leow Xian Zu"
date: "16 Sep 2024"
date-modified: "last-modified"
execute:
  eval: true
  echo: true 
  message: false #no more warning message
  freeze: true #whatever document already commited does not render
---

# Geographically weighted summary statistics, gwModel methods

bw.gwr is the method to recommend the bandwidth to cut off, or if using adaptive distance, the optimal number of neighbours to get statistifically signifant insights as much as possible.

```{r}
pacman::p_load(sf, spdep, tmap, tidyverse, knitr, GWmodel, ggstatsplot)


hunan_sf <- st_read(dsn = "data/geospatial", 
                 layer = "Hunan")
hunan2012 <- read_csv("data/aspatial/Hunan_2012.csv") #read_csv is better
hunan_sf <- left_join(hunan_sf, hunan2012) %>%
  dplyr::select(1:3, 7, 15, 16, 17, 31, 32)
```

In order to use GWModel, we need to convert from sf to sp.
Use the following chunk.

```{r}
hunan_sp <- hunan_sf %>%
  as_Spatial()
```

```{r}
bw_CV <- bw.gwr(GDPPC ~ 1,
                data = hunan_sp,
                approach = "CV",
                adaptive = TRUE,
                kernel = "bisquare",
                longlat = T)
```

```{r}
bw_CV <- bw.gwr(GDPPC ~ 1,
                data = hunan_sp,
                approach = "AIC",
                adaptive = TRUE, #if this is false, then it's fixed bandwidth
                kernel = "bisquare",
                longlat = T) #longlat indicates that it is in decimel degree. documentation says if it's set to TRUE, it applies "great circle distance calculation" Only thing to take note here, is because it is global, it is in kilometres (converted to kilometres). Later when we see the results of a fixed kernel, they are in km.
```

Starts with all (88), after that, it chips away the neighbours, to 22. And that's the optimal number of neighbours. Based on GDP per capita, the optimal neighbour is 22.